//creature.js
//Nicholas Norman November 2025
//Creature for creature scholarship

var creature = document.getElementById("creature");

//pull from original python file using Tkinter
//moving to js to get color and more shareable

var head = [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,1,1,3,1,3,1,3,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,1,2,1,1,1,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,1,2,1,1,2,1,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,2,3,1,2,1,2,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
]

var legs1 = [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,11,11,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,11,11,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,11,11,0,0,0,0,11,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,11,11,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,11,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,11,11,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,11,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,11,11,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
]

var tail = [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,6,6,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,6,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,6,6,6,6,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    ]

var body = [
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0,10, 4, 4, 4, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 4, 4, 4, 4,10, 4, 4, 4, 4, 4, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4,10, 4, 0, 0, 0, 0],
    [0, 0, 0, 0, 0,10, 4, 4, 4, 4,10, 4,10, 4, 4, 4, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0,10, 4, 4, 4, 4, 4, 4, 4, 4,10, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 4, 4,10, 4, 4, 4, 4, 4,10, 4, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 4,10, 4, 4,10, 4, 4,10, 4, 4, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 4, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
]

var background = [
    [7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,8],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0],
    [9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0],
    [0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8],
    [9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,7,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7]
]

var numberMap = {
    0: " ",
    1: "3",
    2: "$",
    3: "%",
    4: "}",
    5: "X",
    6: "z",
    7: "@",
    8: ".",
    9: ",",
    10: "{",
    11: "v"
};

var colorMap = {
    "$" : "#820303ff",
    "%" : "#983b2aff",
    "3" : "#e02a45ff",
    "X" : "#ffffff",
    "z" : "#392b64ff",
    "@" : "#006c1bff",
    "." : "#3f3f3fff",
    "," : "#65ed10ff",
    "}" : "#a36008ff",
    "{" : "#e0f331ff",
    "v" : "#0eece1ff",
}

// mathematical operators because js doesnt have them :(

function mod(n, m) {
  return ((n % m) + m) % m;
}

function sign(x) {
    if (x > 0) {
        return 1;
    } else if (x < 0) {
        return -1;
    } else {
        return 0;
    }
}

function adjustLayer(offsetX, offsetY, part) {
    let output = Array.from({ length: 20 }, () => Array(20).fill(0));

    for (let i = 0; i < part.length; i++) {
        for (let j = 0; j < part[i].length; j++) {
            if (part[i][j] !== 0) {
                if ((i - offsetY) >= output.length || (i - offsetY) < 0) {
                    continue;
                } else if (j + offsetX >= output.length || j + offsetX < 0) {
                    continue;
                } else {
                    output[i - offsetY][j + offsetX] = part[i][j];
                }
            }
        }
    }

    return output;
}

function adjustLayerLoop(offsetX, offsetY, part) {
    var output = Array.from({ length: 20 }, () => Array(20).fill(0));

    offsetX = Math.round(offsetX);
    offsetY = Math.round(offsetY);

    for (let i = 0; i < part.length; i++) {
        for (let j = 0; j < part[i].length; j++) {
            if (part[i][j] !== 0) {
                let yi = mod((i - offsetY + output.length), output.length);
                let xi = mod((j + offsetX + output.length), output.length);
                output[yi][xi] = part[i][j];
            }
        }
    }

    return output;
}

function mapCharacters(layer) {
    let output = "";

    for (let i = 0; i < layer.length; i++) {
        for (let j = 0; j < layer[i].length; j++) {
            output += numberMap[layer[i][j]];
        }
        output += "<br>";
    }

    return output;
}

function mapColors(base) {
    let chars = Object.keys(colorMap);

    let tempBase = base;

    for (let i = 0; i < chars.length; i++) {
        let replaceText = "<span style='color: " + colorMap[chars[i]] + "'>" + chars[i] + "</span>";
        tempBase = tempBase.replaceAll(chars[i], replaceText);
    }

    return tempBase
}

function displayCreature(layers) {
    let base = [];

    for (let i = 0; i < layers.length; i++) {
        let mappedLayer = mapCharacters(layers[i]);

        for (let j = 0; j < mappedLayer.length; j++) {
            if (j >= base.length) {
                base.push(" ");
            }

            if (mappedLayer[j] !== " ") {
                base[j] = mappedLayer[j];
            }
        }
    }

    base = base.join("");

    // deal with spaces
    base = base.replaceAll(" ","&nbsp;");

    coloredBase = mapColors(base);

    console.log(coloredBase);

    creature.innerHTML = coloredBase;
}

function updateOffsets(h, k, rx, ry, speed, n, backgroundLoop) {
    let x = h + rx * Math.sin(n);
    let y = k + ry * Math.sin(2 * n);
    n += speed;
    backgroundLoop += 0.5;

    x = Math.round(x);
    y = Math.round(y);

    let layer5 = adjustLayerLoop(0, backgroundLoop, background);
    let layer4 = adjustLayer(sign(x), sign(y) * -1 * 2, tail);
    let layer3 = adjustLayer(sign(x), sign(y), legs1);
    let layer2 = adjustLayer(0, 0, body);
    let layer1 = adjustLayer(x, y, head);

    let layers = [layer5, layer4, layer2, layer3, layer1];

    displayCreature(layers);
    
    setTimeout(() => updateOffsets(h, k, rx, ry, speed, n, backgroundLoop), 20);
}

updateOffsets(5, 0, 2, 2, 0.1, 0, 0);